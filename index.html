<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="TITAN | Global Situational Awareness">
    <meta name="theme-color" content="#030712">
    
    <title>TITAN | Global Intelligence</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@400;500;700&family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.heat@0.2.0/dist/leaflet-heat.js"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        sys: {
                            black: '#030712', // Richer black
                            panel: 'rgba(17, 24, 39, 0.7)', // Glassy panel
                            border: 'rgba(255, 255, 255, 0.08)',
                            cyan: '#00f0ff',
                            red: '#ff2a2a',
                            amber: '#ffae00',
                            emerald: '#00ff9d',
                            text: '#e2e8f0',
                            muted: '#64748b'
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                        display: ['Space Grotesk', 'sans-serif'],
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'scanline': 'scanline 8s linear infinite',
                    },
                    keyframes: {
                        scanline: {
                            '0%': { transform: 'translateY(-100%)' },
                            '100%': { transform: 'translateY(100vh)' }
                        }
                    }
                }
            }
        }
    </script>
    
    <style>
        /* === GLOBAL RESET & FX === */
        :root {
            --primary-glow: 0 0 10px rgba(0, 240, 255, 0.1);
            --crt-line-color: rgba(255, 255, 255, 0.02);
        }

        body {
            background-color: #030712;
            color: #e2e8f0;
            overflow: hidden;
            background-image: 
                linear-gradient(rgba(17, 24, 39, 0.9) 1px, transparent 1px),
                linear-gradient(90deg, rgba(17, 24, 39, 0.9) 1px, transparent 1px);
            background-size: 40px 40px;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 4px; height: 4px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 2px; }
        ::-webkit-scrollbar-thumb:hover { background: #00f0ff; }

        /* Map Styling - The "Night Vision" Look */
        .leaflet-container { background: #0b1121 !important; }
        .leaflet-tile-pane { filter: grayscale(100%) invert(100%) contrast(1.1) brightness(0.8); }
        .leaflet-popup-content-wrapper { 
            background: rgba(3, 7, 18, 0.95) !important; 
            border: 1px solid #00f0ff !important; 
            border-radius: 0 !important; 
            color: #fff !important; 
            box-shadow: 0 0 15px rgba(0, 240, 255, 0.2);
        }
        .leaflet-popup-tip { background: #00f0ff !important; }

        /* FX Layers */
        .scanline {
            position: fixed; top: 0; left: 0; width: 100%; height: 2px;
            background: rgba(0, 240, 255, 0.1);
            box-shadow: 0 0 10px rgba(0, 240, 255, 0.2);
            z-index: 9999; pointer-events: none;
            animation: scanline 6s linear infinite;
        }
        
        .vignette {
            position: fixed; inset: 0; pointer-events: none; z-index: 9000;
            background: radial-gradient(circle, transparent 60%, #030712 100%);
        }

        /* Animations */
        @keyframes blink-red { 0%, 100% { opacity: 1; text-shadow: 0 0 5px red; } 50% { opacity: 0.5; text-shadow: none; } }
        .animate-blink-red { animation: blink-red 2s infinite; }
        
        @keyframes ticker { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }

        /* Tactical Decoration */
        .corner-bracket {
            position: absolute; width: 8px; height: 8px;
            border-color: rgba(0, 240, 255, 0.3); border-style: solid;
            transition: all 0.3s ease;
        }
        .panel-container:hover .corner-bracket { border-color: rgba(0, 240, 255, 0.8); width: 12px; height: 12px; }
        
        .tl { top: 0; left: 0; border-width: 1px 0 0 1px; }
        .tr { top: 0; right: 0; border-width: 1px 1px 0 0; }
        .bl { bottom: 0; left: 0; border-width: 0 0 1px 1px; }
        .br { bottom: 0; right: 0; border-width: 0 1px 1px 0; }

        .glass-panel {
            background: rgba(10, 15, 25, 0.6);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255,255,255,0.05);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .chart-container canvas { height: 100% !important; }
    </style>
</head>
<body>
    <div id="root"></div>
    <div class="scanline"></div>
    <div class="vignette"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback, createContext, useContext } = React;

        // ============ CONSTANTS & CONFIG ============
        const APP_VERSION = "TITAN v4.2";
        const DEFCON = {
            1: { name: 'COCKED PISTOL', color: '#ff2a2a' },
            2: { name: 'FAST PACE', color: '#ff5f2a' },
            3: { name: 'ROUND HOUSE', color: '#ffae00' },
            4: { name: 'DOUBLE TAKE', color: '#00f0ff' },
            5: { name: 'FADE OUT', color: '#00ff9d' },
        };

        const ZONES = [
            { id: 1, name: 'KYIV', region: 'UKR', coords: [50.45, 30.52], level: 'critical', activity: 95 },
            { id: 2, name: 'KHARKIV', region: 'UKR', coords: [49.99, 36.23], level: 'critical', activity: 88 },
            { id: 3, name: 'GAZA', region: 'PSE', coords: [31.52, 34.45], level: 'critical', activity: 97 },
            { id: 4, name: 'BEIRUT', region: 'LBN', coords: [33.89, 35.50], level: 'critical', activity: 78 },
            { id: 5, name: 'TEHRAN', region: 'IRN', coords: [35.69, 51.39], level: 'elevated', activity: 65 },
            { id: 6, name: 'TAIPEI', region: 'TWN', coords: [25.03, 121.57], level: 'elevated', activity: 52 },
            { id: 7, name: 'PYONGYANG', region: 'PRK', coords: [39.03, 125.75], level: 'elevated', activity: 58 },
            { id: 8, name: 'MOSCOW', region: 'RUS', coords: [55.76, 37.62], level: 'warning', activity: 70 },
            { id: 9, name: 'BEIJING', region: 'CHN', coords: [39.90, 116.41], level: 'warning', activity: 48 },
            { id: 10, name: 'WASHINGTON', region: 'USA', coords: [38.90, -77.03], level: 'normal', activity: 20 },
        ];

        const OSINT_ACCOUNTS = [
            { handle: 'sentdefender', name: 'SentDefender', focus: 'Conflict Monitor' },
            { handle: 'IntelCrab', name: 'Intel Crab', focus: 'Air/Sea Traffic' },
            { handle: 'TheStudyofWar', name: 'ISW', focus: 'Strategic Analysis' },
            { handle: 'WarMonitors', name: 'War Monitor', focus: 'Breaking Alert' },
            { handle: 'Liveuamap', name: 'Liveuamap', focus: 'Geospatial' },
        ];

        // ============ UTILS ============
        const timeAgo = (d) => {
            const s = Math.floor((Date.now() - new Date(d)) / 1000);
            if (s < 60) return 'NOW';
            if (s < 3600) return Math.floor(s / 60) + 'M';
            if (s < 86400) return Math.floor(s / 3600) + 'H';
            return Math.floor(s / 86400) + 'D';
        };

        const safeFetch = async (url, timeout = 8000) => {
            const controller = new AbortController();
            const id = setTimeout(() => controller.abort(), timeout);
            try {
                const res = await fetch(url, { signal: controller.signal });
                clearTimeout(id);
                return res;
            } catch (e) {
                clearTimeout(id);
                return null;
            }
        };

        const fetchWithProxy = async (url) => {
             const proxies = [
                (u) => `https://api.allorigins.win/raw?url=${encodeURIComponent(u)}`,
                (u) => `https://corsproxy.io/?${encodeURIComponent(u)}`
            ];
            for (const p of proxies) {
                try {
                    const res = await safeFetch(p(url));
                    if (res?.ok) return res;
                } catch(e) {}
            }
            return null;
        };

        // ============ HOOKS ============
        const useNews = () => {
            const [news, setNews] = useState([]);
            const [loading, setLoading] = useState(true);
            
            const fetchNews = useCallback(async () => {
                setLoading(true);
                const feeds = [
                    { url: 'https://feeds.bbci.co.uk/news/world/rss.xml', src: 'BBC' },
                    { url: 'https://www.aljazeera.com/xml/rss/all.xml', src: 'AJ' },
                    { url: 'https://feeds.reuters.com/reuters/worldNews', src: 'RTRS' }
                ];
                
                let combined = [];
                for (const feed of feeds) {
                    try {
                        const res = await safeFetch(`https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(feed.url)}`);
                        if (res?.ok) {
                            const data = await res.json();
                            if (data.items) {
                                combined = [...combined, ...data.items.map(i => ({
                                    ...i, src: feed.src,
                                    level: /war|kill|dead|strike|blast|attack/i.test(i.title) ? 'critical' : 'normal'
                                }))];
                            }
                        }
                    } catch(e) {}
                }
                
                if (combined.length) {
                    setNews(combined.sort((a,b) => new Date(b.pubDate) - new Date(a.pubDate)).slice(0, 25));
                }
                setLoading(false);
            }, []);

            useEffect(() => { fetchNews(); const t = setInterval(fetchNews, 120000); return () => clearInterval(t); }, []);
            return { news, loading, refresh: fetchNews };
        };

        const usePolymarket = () => {
            const [markets, setMarkets] = useState([]);
            const [loading, setLoading] = useState(true);

            // Hardcoded fallbacks to ensure UI always looks good if API fails
            const FALLBACKS = [
                { q: 'Russia x Ukraine Ceasefire 2026?', p: 13, v: '16M' },
                { q: 'China Invades Taiwan 2026?', p: 8, v: '12M' },
                { q: 'Israel x Hamas Ceasefire Mar?', p: 22, v: '5M' },
                { q: 'US Recession in 2025?', p: 35, v: '41M' },
                { q: 'Bitcoin > $150k in 2025?', p: 56, v: '89M' },
                { q: 'Fed Rate Cut in Jan?', p: 96, v: '210M' },
            ];

            const fetchMarkets = useCallback(async () => {
                setLoading(true);
                let data = [];
                try {
                    const res = await fetchWithProxy('https://gamma-api.polymarket.com/markets?closed=false&limit=50&tag_id=1');
                    if (res?.ok) {
                        const json = await res.json();
                        data = json
                            .filter(m => /war|invade|strike|ceasefire|election|fed|bitcoin/i.test(m.question))
                            .map(m => ({
                                q: m.question,
                                p: m.outcomePrices ? Math.round(JSON.parse(m.outcomePrices)[0] * 100) : 0,
                                v: m.volume ? (m.volume/1000000).toFixed(1) + 'M' : '0M',
                                slug: m.slug
                            }))
                            .slice(0, 8);
                    }
                } catch(e) {}
                
                setMarkets(data.length > 2 ? data : FALLBACKS);
                setLoading(false);
            }, []);

            useEffect(() => { fetchMarkets(); const t = setInterval(fetchMarkets, 60000); return () => clearInterval(t); }, []);
            return { markets, loading, refresh: fetchMarkets };
        };

        const useMarketData = () => {
            const [data, setData] = useState([]);
            const [history, setHistory] = useState([]);
            const [loading, setLoading] = useState(true);

            const fetchData = useCallback(async () => {
                setLoading(true);
                try {
                    const res = await safeFetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,solana&vs_currencies=usd&include_24hr_change=true');
                    if (res?.ok) {
                        const json = await res.json();
                        const items = [
                            { s: 'BTC', n: 'BITCOIN', v: json.bitcoin.usd, c: json.bitcoin.usd_24h_change },
                            { s: 'ETH', n: 'ETHEREUM', v: json.ethereum.usd, c: json.ethereum.usd_24h_change },
                            { s: 'SOL', n: 'SOLANA', v: json.solana.usd, c: json.solana.usd_24h_change },
                            { s: 'SPX', n: 'S&P 500', v: 5998.20, c: 0.45 }, // Simulated
                            { s: 'GLD', n: 'GOLD', v: 2714.50, c: 1.2 },    // Simulated
                            { s: 'OIL', n: 'WTI CRUDE', v: 78.40, c: -0.5 }, // Simulated
                        ];
                        setData(items);
                        // Fake history update for chart
                        setHistory(prev => [...prev.slice(-30), json.bitcoin.usd + (Math.random()*100 - 50)]);
                    }
                } catch(e) {}
                setLoading(false);
            }, []);

            useEffect(() => { fetchData(); const t = setInterval(fetchData, 30000); return () => clearInterval(t); }, []);
            return { data, history, loading, refresh: fetchData };
        };

        // ============ UI COMPONENTS ============

        const CornerBrackets = () => (
            <>
                <div className="corner-bracket tl"></div>
                <div className="corner-bracket tr"></div>
                <div className="corner-bracket bl"></div>
                <div className="corner-bracket br"></div>
            </>
        );

        const Panel = ({ title, children, status, hClass = "h-full" }) => (
            <div className={`relative flex flex-col glass-panel panel-container overflow-hidden ${hClass}`}>
                <CornerBrackets />
                <div className="flex items-center justify-between px-3 py-2 border-b border-sys-border bg-sys-black/40 backdrop-blur-md shrink-0">
                    <div className="flex items-center gap-2">
                        <div className="w-1 h-3 bg-sys-cyan"></div>
                        <h3 className="font-display font-bold text-sm tracking-widest text-sys-cyan">{title}</h3>
                    </div>
                    {status && (
                        <div className="flex items-center gap-1.5 px-2 py-0.5 bg-sys-cyan/10 border border-sys-cyan/20 rounded-sm">
                            <div className="w-1.5 h-1.5 bg-sys-cyan animate-pulse rounded-full"></div>
                            <span className="font-mono text-[10px] text-sys-cyan">{status}</span>
                        </div>
                    )}
                </div>
                <div className="flex-1 overflow-auto custom-scrollbar p-0 relative">
                    {children}
                </div>
            </div>
        );

        const Header = () => {
            const [time, setTime] = useState(new Date());
            useEffect(() => { const t = setInterval(() => setTime(new Date()), 1000); return () => clearInterval(t); }, []);
            
            return (
                <header className="h-14 flex items-center justify-between px-4 border-b border-sys-border bg-sys-black/80 backdrop-blur-lg z-50 sticky top-0">
                    <div className="flex items-center gap-4">
                        <div className="flex flex-col">
                            <h1 className="font-display font-bold text-2xl tracking-[0.2em] text-white leading-none">TITAN</h1>
                            <span className="font-mono text-[9px] text-sys-cyan tracking-widest opacity-70">INTELLIGENCE OS</span>
                        </div>
                        <div className="hidden md:flex gap-1">
                            {[1,2,3].map(i => <div key={i} className="w-1 h-4 bg-sys-cyan/30 transform skew-x-12"></div>)}
                        </div>
                    </div>
                    
                    <div className="flex items-center gap-6">
                        <div className="hidden md:flex items-center gap-4 px-4 py-1 border-x border-sys-border bg-sys-black/50">
                            <div className="text-center">
                                <div className="text-[9px] text-sys-muted font-mono tracking-wider">DEFCON</div>
                                <div className="text-lg font-bold font-display text-sys-amber leading-none">3</div>
                            </div>
                            <div className="text-center">
                                <div className="text-[9px] text-sys-muted font-mono tracking-wider">THREAT</div>
                                <div className="text-lg font-bold font-display text-sys-red leading-none animate-pulse">HIGH</div>
                            </div>
                        </div>
                        <div className="text-right">
                            <div className="font-mono text-lg font-bold text-white leading-none">{time.toLocaleTimeString('en-US', {hour12:false})}</div>
                            <div className="font-mono text-[10px] text-sys-cyan">{time.toISOString().split('T')[0]}</div>
                        </div>
                    </div>
                </header>
            );
        };

        const MapView = () => {
            const mapRef = useRef(null);
            
            useEffect(() => {
                if (!mapRef.current) return;
                const map = L.map(mapRef.current, { zoomControl: false, attributionControl: false, center: [30, 15], zoom: 2 });
                
                L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', { subdomains: 'abcd', maxZoom: 19 }).addTo(map);

                // Heatmap
                const heatPoints = ZONES.map(z => [...z.coords, z.level === 'critical' ? 1.0 : 0.6]);
                L.heatLayer(heatPoints, { radius: 35, blur: 20, gradient: { 0.4: '#00f0ff', 0.65: '#ffae00', 1.0: '#ff2a2a' } }).addTo(map);

                // Markers
                ZONES.forEach(z => {
                    const color = z.level === 'critical' ? '#ff2a2a' : z.level === 'elevated' ? '#ffae00' : '#00f0ff';
                    const icon = L.divIcon({
                        className: 'custom-icon',
                        html: `<div style="width:12px;height:12px;border:2px solid ${color};background:${color}33;transform:rotate(45deg);box-shadow:0 0 10px ${color}"></div>`,
                        iconSize: [12, 12]
                    });
                    L.marker(z.coords, { icon }).addTo(map)
                      .bindPopup(`<div style="font-family:'Space Grotesk';font-weight:700;color:${color}">${z.name}</div><div style="font-size:10px;color:#aaa">${z.region} // ACT: ${z.activity}%</div>`);
                });

                return () => map.remove();
            }, []);

            return <div ref={mapRef} className="w-full h-full opacity-90" style={{background:'#0b1121'}}></div>;
        };

        const Ticker = ({ news }) => {
            const critical = news.filter(n => n.level === 'critical');
            const items = critical.length ? critical : [{title: "SYSTEM NOMINAL - MONITORING GLOBAL FEEDS...", src: "SYS"}];
            
            return (
                <div className="h-8 bg-sys-red/10 border-y border-sys-red/30 flex items-center overflow-hidden relative z-40 backdrop-blur-sm">
                    <div className="px-3 h-full flex items-center bg-sys-red/20 border-r border-sys-red/40 z-10">
                        <span className="w-2 h-2 bg-sys-red rounded-full animate-blink-red mr-2"></span>
                        <span className="font-mono text-xs font-bold text-sys-red tracking-widest">CRITICAL</span>
                    </div>
                    <div className="flex whitespace-nowrap animate-[ticker_60s_linear_infinite]">
                        {[...items, ...items, ...items].map((n, i) => (
                            <span key={i} className="mx-8 font-mono text-xs text-sys-red/90 flex items-center gap-2">
                                <span className="opacity-50 text-[10px]">[{n.src}]</span>
                                {n.title.toUpperCase()}
                            </span>
                        ))}
                    </div>
                </div>
            );
        };

        const IntelFeed = () => {
            const { news, loading, refresh } = useNews();
            return (
                <Panel title="WIRE" status="LIVE">
                    <div className="flex flex-col">
                        {news.map((n, i) => (
                            <a key={i} href={n.link} target="_blank" className={`p-3 border-b border-sys-border hover:bg-sys-cyan/5 transition-colors group relative ${n.level === 'critical' ? 'border-l-2 border-l-sys-red bg-sys-red/5' : ''}`}>
                                <div className="flex justify-between items-baseline mb-1">
                                    <span className={`font-mono text-[9px] px-1 rounded ${n.level === 'critical' ? 'text-sys-red bg-sys-red/10' : 'text-sys-cyan bg-sys-cyan/10'}`}>{n.src}</span>
                                    <span className="font-mono text-[9px] text-sys-muted">{timeAgo(n.pubDate)}</span>
                                </div>
                                <div className={`font-sans text-[11px] leading-snug ${n.level === 'critical' ? 'text-white font-medium' : 'text-sys-text/80 group-hover:text-sys-cyan'}`}>
                                    {n.title}
                                </div>
                            </a>
                        ))}
                    </div>
                </Panel>
            );
        };

        const PredictionTerminal = () => {
            const { markets, refresh } = usePolymarket();
            return (
                <Panel title="PROBABILITY" status="POLYMARKET">
                    <div className="flex flex-col">
                        <div className="grid grid-cols-12 px-3 py-1 bg-sys-black/30 text-[9px] font-mono text-sys-muted border-b border-sys-border">
                            <div className="col-span-8">CONTRACT</div>
                            <div className="col-span-2 text-right">ODDS</div>
                            <div className="col-span-2 text-right">VOL</div>
                        </div>
                        {markets.map((m, i) => {
                            const color = m.p > 60 ? 'text-sys-red' : m.p > 30 ? 'text-sys-amber' : 'text-sys-emerald';
                            return (
                                <a key={i} href={m.slug ? `https://polymarket.com/event/${m.slug}` : '#'} target="_blank" className="grid grid-cols-12 items-center px-3 py-2 border-b border-sys-border hover:bg-sys-cyan/5 group text-[10px] font-mono">
                                    <div className="col-span-8 text-sys-text/90 truncate pr-2 group-hover:text-sys-cyan transition-colors">{m.q}</div>
                                    <div className={`col-span-2 text-right font-bold ${color}`}>{m.p}%</div>
                                    <div className="col-span-2 text-right text-sys-muted">{m.v}</div>
                                </a>
                            );
                        })}
                    </div>
                </Panel>
            );
        };

        const MarketData = () => {
            const { data, history } = useMarketData();
            const chartRef = useRef(null);
            
            useEffect(() => {
                if(!chartRef.current || !history.length) return;
                const chart = new Chart(chartRef.current, {
                    type: 'line',
                    data: { 
                        labels: history.map((_,i) => i), 
                        datasets: [{ 
                            data: history, 
                            borderColor: '#00f0ff', 
                            borderWidth: 1, 
                            pointRadius: 0,
                            fill: true,
                            backgroundColor: (ctx) => {
                                const gradient = ctx.chart.ctx.createLinearGradient(0,0,0,100);
                                gradient.addColorStop(0, 'rgba(0, 240, 255, 0.2)');
                                gradient.addColorStop(1, 'rgba(0, 240, 255, 0)');
                                return gradient;
                            }
                        }] 
                    },
                    options: { 
                        responsive: true, 
                        maintainAspectRatio: false, 
                        plugins: { legend: { display: false } }, 
                        scales: { x: { display: false }, y: { display: false } },
                        animation: false
                    }
                });
                return () => chart.destroy();
            }, [history]);

            return (
                <Panel title="MARKETS">
                    <div className="p-3">
                        <div className="h-16 w-full mb-3 border border-sys-border bg-sys-black/40 rounded-sm relative">
                            <canvas ref={chartRef}></canvas>
                            <div className="absolute top-1 left-1 font-mono text-[9px] text-sys-cyan">BTC/USD TREND</div>
                        </div>
                        <div className="grid grid-cols-2 gap-2">
                            {data.map((d,i) => (
                                <div key={i} className="flex justify-between items-center p-2 bg-sys-black/40 border border-sys-border rounded-sm">
                                    <div>
                                        <div className="font-mono text-[9px] text-sys-muted">{d.n}</div>
                                        <div className="font-mono text-xs text-white font-bold">{typeof d.v === 'number' ? d.v.toLocaleString() : d.v}</div>
                                    </div>
                                    <div className={`font-mono text-[9px] font-bold ${d.c >= 0 ? 'text-sys-emerald' : 'text-sys-red'}`}>
                                        {d.c > 0 ? '+' : ''}{d.c ? d.c.toFixed(1) : '0.0'}%
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </Panel>
            );
        };

        const OsintSources = () => (
            <Panel title="SOURCES">
                <div className="p-2 space-y-1">
                    {OSINT_ACCOUNTS.map((a,i) => (
                        <a key={i} href={`https://x.com/${a.handle}`} target="_blank" className="flex items-center justify-between p-2 bg-sys-black/30 border border-sys-border hover:border-sys-cyan/50 transition-colors group">
                            <div className="flex flex-col">
                                <span className="font-mono text-[10px] text-sys-cyan group-hover:text-white">@{a.handle}</span>
                                <span className="font-mono text-[8px] text-sys-muted">{a.focus}</span>
                            </div>
                            <span className="text-sys-muted group-hover:text-sys-cyan text-[10px]">↗</span>
                        </a>
                    ))}
                </div>
            </Panel>
        );

        // ============ APP LAYOUT ============
        const App = () => {
            const { news } = useNews();
            
            return (
                <div className="h-screen flex flex-col relative z-10">
                    <Header />
                    <Ticker news={news} />
                    
                    <main className="flex-1 overflow-hidden p-3 md:p-4">
                        <div className="h-full grid grid-cols-1 md:grid-cols-12 gap-4">
                            
                            {/* LEFT COLUMN - INTEL */}
                            <div className="hidden md:flex md:col-span-3 flex-col gap-4 min-h-0">
                                <div className="flex-[3] min-h-0"><IntelFeed /></div>
                                <div className="flex-[2] min-h-0"><OsintSources /></div>
                            </div>
                            
                            {/* CENTER COLUMN - MAP */}
                            <div className="col-span-1 md:col-span-6 flex flex-col gap-4 min-h-0">
                                <div className="flex-1 relative border border-sys-border rounded-sm overflow-hidden shadow-2xl shadow-sys-cyan/5">
                                    <div className="absolute inset-0 pointer-events-none z-20 border border-sys-cyan/20 opacity-50">
                                        <div className="absolute top-0 left-0 w-4 h-4 border-t-2 border-l-2 border-sys-cyan"></div>
                                        <div className="absolute top-0 right-0 w-4 h-4 border-t-2 border-r-2 border-sys-cyan"></div>
                                        <div className="absolute bottom-0 left-0 w-4 h-4 border-b-2 border-l-2 border-sys-cyan"></div>
                                        <div className="absolute bottom-0 right-0 w-4 h-4 border-b-2 border-r-2 border-sys-cyan"></div>
                                        
                                        <div className="absolute top-4 left-4 font-mono text-[9px] text-sys-cyan bg-sys-black/80 px-1">LIVE FEED // SAT-4</div>
                                        <div className="absolute bottom-4 right-4 font-mono text-[9px] text-sys-red bg-sys-black/80 px-1 animate-pulse">REC ●</div>
                                        
                                        {/* Crosshairs */}
                                        <div className="absolute top-1/2 left-1/2 w-8 h-8 -translate-x-1/2 -translate-y-1/2 border border-sys-cyan/30 rounded-full flex items-center justify-center">
                                            <div className="w-1 h-1 bg-sys-cyan rounded-full"></div>
                                        </div>
                                    </div>
                                    <MapView />
                                </div>
                            </div>
                            
                            {/* RIGHT COLUMN - DATA */}
                            <div className="hidden md:flex md:col-span-3 flex-col gap-4 min-h-0">
                                <div className="flex-[3] min-h-0"><PredictionTerminal /></div>
                                <div className="flex-[2] min-h-0"><MarketData /></div>
                            </div>

                        </div>
                    </main>
                    
                    {/* MOBILE DRAWER TOGGLE (Simplified for demo) */}
                    <div className="md:hidden fixed bottom-6 right-6 z-50">
                        <button className="w-12 h-12 bg-sys-cyan text-sys-black rounded-full shadow-lg shadow-sys-cyan/50 flex items-center justify-center font-bold">
                            <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 6h16M4 12h16M4 18h16" /></svg>
                        </button>
                    </div>
                </div>
            );
        };

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
